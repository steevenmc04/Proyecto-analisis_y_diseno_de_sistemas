<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Iniciar Sesión</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body class="login-page">
    <div class="login-container">
        <div class="login-card">
            <div class="login-header">
                <div class="logo-container">
                    <div class="logo-icon">
                        <img src="images/logo.png" alt="Logo Corporal Gym" width="64" height="64">
                    </div>
                    <h1>Corporal Gym</h1>
                </div>
                <h2>Iniciar Sesión</h2>
            </div>
            
            <form id="loginForm" class="login-form">
                <div class="form-group">
                    <label for="user" class="form-label">Usuario</label>
                    <div class="input-container">
                        <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="#9CA3AF"/>
                        </svg>
                        <input type="text" id="user" placeholder="Cédula o Email" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="password" class="form-label">Contraseña</label>
                    <div class="input-container">
                        <svg class="input-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18 8H17V6C17 3.24 14.76 1 12 1C9.24 1 7 3.24 7 6V8H6C4.9 8 4 8.9 4 10V20C4 21.1 4.9 22 6 22H18C19.1 22 20 21.1 20 20V10C20 8.9 19.1 8 18 8ZM12 17C10.9 17 10 16.1 10 15C10 13.9 10.9 13 12 13C13.1 13 14 13.9 14 15C14 16.1 13.1 17 12 17ZM15.1 8H8.9V6C8.9 4.29 10.29 2.9 12 2.9C13.71 2.9 15.1 4.29 15.1 6V8Z" fill="#9CA3AF"/>
                        </svg>
                        <input type="password" id="password" placeholder="Ingresa tu contraseña" required>
                    </div>
                </div>
                
                <div class="form-options">
                    <label class="checkbox-container">
                        <input type="checkbox" id="remember">
                        <span class="checkmark"></span>
                        Recordar sesión
                    </label>
                </div>
                
                <button type="submit" class="login-button">
                    <span>Iniciar Sesión</span>
                    <svg class="button-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z" fill="currentColor"/>
                    </svg>
                </button>
            </form>
            
            <div class="login-footer">
                <p>¿No tienes una cuenta? <a href="register.html" class="register-link">Regístrate aquí</a></p>
            </div>
        </div>
        
        <div class="login-background">
            <div class="background-pattern"></div>
        </div>
    </div>

    <script>
        document.getElementById("loginForm").addEventListener("submit", async e => {
            e.preventDefault();
            const user = document.getElementById("user").value.trim();
            const password = document.getElementById("password").value.trim();
            
            if (!user || !password) {
                showNotification("Todos los campos son obligatorios", "error");
                return;
            }
            
            // Show loading state
            const button = document.querySelector('.login-button');
            const originalText = button.innerHTML;
            button.innerHTML = '<span>Iniciando sesión...</span>';
            button.disabled = true;
            
            try {
                const res = await fetch("http://localhost:3000/login", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ user, password })
                });
                
                const result = await res.json();
                
                if (res.ok) {
                    localStorage.setItem("token", result.token);
                    showNotification("✅ Login exitoso", "success");
                    setTimeout(() => {
                        window.location.href = "index.html";
                    }, 1000);
                } else {
                    showNotification("❌ " + (result.message || "Credenciales incorrectas"), "error");
                }
            } catch (error) {
                showNotification("❌ Error de conexión", "error");
            } finally {
                // Restore button state
                button.innerHTML = originalText;
                button.disabled = false;
            }
        });
        
        function showNotification(message, type) {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            // Add to page
            document.body.appendChild(notification);
            
            // Show notification
            setTimeout(() => notification.classList.add('show'), 100);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => notification.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>